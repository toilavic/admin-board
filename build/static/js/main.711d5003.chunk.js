(this["webpackJsonpcreate-react-app-with-typescript"]=this["webpackJsonpcreate-react-app-with-typescript"]||[]).push([[0],{154:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),i=n.n(o),c=n(192),s=n(200),l=n(21),d=n(28),u=n(11),j=n(187),b=Object(j.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(img/chess.jpg)",backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),m=n(190),p=n(156),h=n(204),f=n(193),g=n(201),O=n(196),x=n(66),v=n.n(x),w=n(93),k=n(31),y=n(44),S=n(32),N=n(33),C=n.n(N);var I=n(2),A=function(e){var t=e.onLoginRedirect,n=e.history,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(a.useState)(t),r=Object(y.a)(n,2),o=r[0],i=r[1];return{onChange:function(e){i(Object(d.a)(Object(d.a)({},o),{},Object(k.a)({},e.target.name,e.target.value)))},onSubmit:function(){var t=Object(w.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,e();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),values:o}}((function(){(e=s,C.a.post(S.baseAddress+"login",e).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))).then((function(e){if(401===e.status){var a=e.data;alert(a)}else{var r=e.data;r&&("admin"===r.user.permissionLevel?(localStorage.setItem("token",r.token),localStorage.setItem("refreshToken",r.refreshToken),n.push(t)):alert("you are not admin"))}}));var e}),{email:"",password:""}),o=r.onChange,i=r.onSubmit,s=r.values;var l=b();return localStorage.getItem("token")?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(u.a,{to:"/dashboard"})}):Object(I.jsxs)(m.a,{container:!0,component:"main",className:l.root,children:[Object(I.jsx)(c.a,{}),Object(I.jsx)(m.a,{item:!0,xs:!1,sm:4,md:7,className:l.image}),Object(I.jsx)(m.a,{item:!0,xs:12,sm:8,md:5,component:p.a,elevation:6,square:!0,children:Object(I.jsxs)("div",{className:l.paper,children:[Object(I.jsx)(h.a,{className:l.avatar}),Object(I.jsx)(f.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(I.jsxs)("form",{className:l.form,noValidate:!0,onSubmit:i,children:[Object(I.jsx)(g.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Username",name:"email",onChange:o,autoComplete:"email",autoFocus:!0}),Object(I.jsx)(g.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",onChange:o,label:"Password",type:"password",id:"password",autoComplete:"current-password"}),Object(I.jsx)(O.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:l.submit,children:"Sign In"})]})]})})]})},D=180,E=Object(j.a)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),height:55},appBarShift:{width:"calc(100% - ".concat(D,"px)"),height:55,marginLeft:D,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:D,flexShrink:0},drawerPaper:{width:D},drawerHeader:Object(d.a)(Object(d.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-180},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}})),F=n(4),L=n(197),R=n(198),T=n(199),B=n(94),P=n.n(B),W=function(e){var t=e.open,n=e.handleDrawerOpen,a=e.onLogOut,r=E();return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(c.a,{}),Object(I.jsx)(L.a,{position:"fixed",className:Object(F.a)(r.appBar,Object(k.a)({},r.appBarShift,t)),color:"default",children:Object(I.jsxs)(R.a,{children:[Object(I.jsx)(T.a,{color:"inherit","aria-label":"open drawer",onClick:n,edge:"start",className:Object(F.a)(r.menuButton,t&&r.hide),children:Object(I.jsx)(P.a,{})}),Object(I.jsx)(f.a,{variant:"h6",noWrap:!0}),Object(I.jsx)(O.a,{href:"/",onClick:a,style:{marginLeft:"80%",fontSize:16},color:"inherit",children:"Log-out"})]})})]})},q=n(17),z=n(203),H=n(95),J=n.n(H),V=n(96),G=n.n(V),K=function(e){var t=e.open,n=e.handleDrawerClose,a=E(),r=Object(q.a)();return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(z.a,{className:a.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:a.drawerPaper},children:Object(I.jsx)("div",{className:a.drawerHeader,children:Object(I.jsx)(T.a,{color:"inherit",onClick:n,children:"ltr"===r.direction?Object(I.jsx)(J.a,{}):Object(I.jsx)(G.a,{})})})})})},M=function(e){if("action"===e.column.colId&&e.event.target.dataset.action){var t=e.event.target.dataset.action;"edit"===t&&e.api.startEditingCell({rowIndex:e.node.rowIndex,colKey:e.columnApi.getDisplayedCenterColumns()[0].colId}),"delete"===t&&e.api.applyTransaction({remove:[e.node.data]}),"update"===t&&(console.log("update click"),e.api.stopEditing(!1)),"cancel"===t&&e.api.stopEditing(!0)}},U=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},Q=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},X=n(97),Y=(n(150),n(151),n(152),n(98)),Z=n.n(Y);var $=[{headerName:"ID",field:"id",sortable:!0,filter:!0,editable:!1},{headerName:"Key",field:"key",sortable:!0,filter:!0,editable:!1},{headerName:"Name",field:"name",sortable:!0,filter:!0},{headerName:"Owner",field:"owner",sortable:!0,filter:!0},{headerName:"Expires at",field:"expiresAt",sortable:!0,filter:!0,valueFormatter:function(e){return new Date(e.value).toLocaleDateString()}},{headerName:"action",minWidth:150,cellRenderer:function(e){var t=document.createElement("div"),n=e.api.getEditingCells().some((function(t){return t.rowIndex===e.node.rowIndex}));return t.innerHTML=n?'\n  <button  class="action-button update"  data-action="update"> update  </button>\n  <button  class="action-button cancel"  data-action="cancel" > cancel </button>\n  ':'\n  <button class="action-button edit"  data-action="edit" > edit  </button>\n  <button class="action-button delete" data-action="delete" > delete </button>\n  ',t},editable:!1,colId:"action"}],_={editable:!0},ee=function(e){new Date(e.data.expiresAt).toLocaleDateString();Z()({title:"Are you sure?",text:"On my way creating....",icon:"warning",dangerMode:!0})},te=function(e){Object(l.a)(e);var t=Object(a.useState)(),n=Object(y.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){(function(e){return C.a.get(S.baseAddress+"key",{headers:{Authorization:"token ".concat(e)}}).then((function(e){return e.data})).catch((function(e){console.error(e)}))})(localStorage.getItem("token")).then((function(e){return o(e)})).catch((function(e){return console.log(e)}))}),[]),Object(I.jsx)("div",{className:"ag-theme-alpine tcl-mask",style:{width:"90%",height:300},children:Object(I.jsx)(X.AgGridReact,{onRowEditingStopped:Q,onRowEditingStarted:U,onCellClicked:M,columnDefs:$,rowData:r,rowSelection:"multiple",editType:"fullRow",defaultColDef:_,suppressClickEdit:!0,enableRangeSelection:!0,onRowValueChanged:ee})})},ne=n(99),ae=n(205),re=n(101),oe=n.n(re);var ie=function(e){Object(l.a)(e);var t=function(e){e.preventDefault();var t=e.target.name.value,n=e.target.owner.value,a=e.target.expire.value;console.log(a),function(e,t,n){var a=localStorage.getItem("token"),r={name:e,owner:t,expiresAt:n},o={method:"post",headers:{Authorization:"token ".concat(a)},url:S.baseAddress+"key",data:r};return C()(o).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))}(t,n,a).then((function(e){400===e.status?alert(e.data):(alert("created success"),window.location.reload(!1))}))};return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(ne.a,{trigger:Object(I.jsx)(ae.a,{title:"Create a new key",children:Object(I.jsx)(T.a,{children:Object(I.jsx)(oe.a,{})})}),modal:!0,children:function(e){return Object(I.jsxs)("div",{children:[Object(I.jsxs)("form",{onSubmit:t,children:[Object(I.jsx)("div",{className:"form-row"}),Object(I.jsxs)("div",{className:"form-group",children:[Object(I.jsx)("label",{htmlFor:"inputAddress",children:"Name"}),Object(I.jsx)("input",{type:"text",name:"name",className:"form-control",id:"inputAddress",placeholder:""})]}),Object(I.jsxs)("div",{className:"form-group",children:[Object(I.jsx)("label",{htmlFor:"inputAddress2",children:"Owner"}),Object(I.jsx)("input",{type:"text",name:"owner",className:"form-control",id:"inputAddress2",placeholder:""})]}),Object(I.jsxs)("div",{className:"form-group",children:[Object(I.jsx)("label",{htmlFor:"inputAddress2",children:"Expires At"}),Object(I.jsx)("input",{id:"party",name:"expire",type:"datetime-local",defaultValue:"2022-01-01T00:00"})]}),Object(I.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]}),Object(I.jsx)("button",{className:"close",onClick:function(){e()},children:"\xd7"})]})}})})},ce=function(e){return Object(l.a)(e),Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(ie,{}),Object(I.jsx)(te,{})]})};var se=function(e){Object(l.a)(e);var t=E(),n=r.a.useState(!1),o=Object(y.a)(n,2),i=o[0],c=o[1],s=function(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},d=function(){(function(e){return C.a.post(S.baseAddress+"/login",{token:e}).then((function(e){return e.data})).catch((function(e){return e.response.status}))})(localStorage.getItem("refreshToken")).then((function(e){401===e||403===e?(alert("Please login!"),s(),window.location.reload(!1)):localStorage.setItem("token",e.token)})).catch((function(e){return console.error(e)}))};return Object(a.useEffect)((function(){var e=setInterval((function(){null!==localStorage.getItem("token")&&(d(),console.log("This will run every 30 seconds!"))}),3e4);return function(){return clearInterval(e)}})),localStorage.getItem("token")?Object(I.jsxs)("div",{className:t.root,children:[Object(I.jsx)(W,{open:i,handleDrawerOpen:function(){return c(!0)},onLogOut:s}),Object(I.jsx)(K,{open:i,handleDrawerClose:function(){return c(!1)}}),Object(I.jsxs)("main",{className:Object(F.a)(t.content,Object(k.a)({},t.contentShift,i)),children:[Object(I.jsx)("div",{className:t.drawerHeader}),Object(I.jsx)(ce,{})]})]}):Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(u.a,{to:"/"})})},le=function(){return Object(a.useEffect)((function(){})),Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(se,{})})},de=n(35),ue=function(){return Object(I.jsxs)("div",{children:[Object(I.jsx)("h1",{children:"404"}),Object(I.jsx)("h2",{children:"Error: 404 page not found"}),Object(I.jsx)("p",{children:"Sorry, the page you're looking for cannot be accessed"}),Object(I.jsx)(de.b,{to:"/",children:"Click here to go back to home"})]})},je=function(e){return Object(l.a)(e),Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(u.d,{children:[Object(I.jsx)(u.b,{path:"/",exact:!0,render:function(e){return Object(I.jsx)(A,Object(d.a)(Object(d.a)({},e),{},{onLoginRedirect:"/dashboard"}))}}),Object(I.jsx)(u.b,{path:"/dashboard",exact:!0,render:function(e){return Object(I.jsx)(le,Object(d.a)({},e))}}),Object(I.jsx)(u.b,{component:ue})]})})},be=function(e){return Object(l.a)(e),Object(I.jsx)(de.a,{children:Object(I.jsx)(je,{})})},me=n(102),pe=n.n(me),he=n(103),fe=Object(he.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:pe.a.A400},background:{default:"#fff"}}});i.a.render(Object(I.jsxs)(s.a,{theme:fe,children:[Object(I.jsx)(c.a,{}),Object(I.jsx)(be,{})]}),document.querySelector("#root"))},32:function(e){e.exports=JSON.parse('{"baseAddress":"https://api.nome.fi:54321/v1/"}')}},[[154,1,2]]]);
//# sourceMappingURL=main.711d5003.chunk.js.map