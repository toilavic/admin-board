(this["webpackJsonpcreate-react-app-with-typescript"]=this["webpackJsonpcreate-react-app-with-typescript"]||[]).push([[0],{100:function(e,t,n){},15:function(e){e.exports=JSON.parse('{"baseAddress":"https://api.nome.fi:54321/v1/"}')},155:function(e,t,n){},162:function(e,t,n){},163:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),o=n.n(i),c=n(203),s=n(215),l=n(18),d=n(31),u=n(11),h=n(198),j=Object(h.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(img/chess.jpg)",backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),p=n(201),m=n(165),f=n(219),b=n(69),g=n(216),x=n(207),O=n(73),v=n.n(O),w=n(106),y=n(34),k=n(36),N=n(15),C=n(16),S=n.n(C);var A=n(2),I=function(e){var t=e.onLoginRedirect,n=e.history,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(a.useState)(t),r=Object(k.a)(n,2),i=r[0],o=r[1];return{onChange:function(e){o(Object(d.a)(Object(d.a)({},i),{},Object(y.a)({},e.target.name,e.target.value)))},onSubmit:function(){var t=Object(w.a)(v.a.mark((function t(n){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,e();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),values:i}}((function(){(e=s,S.a.post(N.baseAddress+"login",e).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))).then((function(e){if(401===e.status){var a=e.data;alert(a)}else{var r=e.data;r&&("admin"===r.user.permissionLevel?(localStorage.setItem("token",r.token),localStorage.setItem("refreshToken",r.refreshToken),n.push(t)):alert("you are not admin"))}}));var e}),{email:"",password:""}),i=r.onChange,o=r.onSubmit,s=r.values;var l=j();return localStorage.getItem("token")?Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(u.a,{to:"/dashboard"})}):Object(A.jsxs)(p.a,{container:!0,component:"main",className:l.root,children:[Object(A.jsx)(c.a,{}),Object(A.jsx)(p.a,{item:!0,xs:!1,sm:4,md:7,className:l.image}),Object(A.jsx)(p.a,{item:!0,xs:12,sm:8,md:5,component:m.a,elevation:6,square:!0,children:Object(A.jsxs)("div",{className:l.paper,children:[Object(A.jsx)(f.a,{className:l.avatar}),Object(A.jsx)(b.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(A.jsxs)("form",{className:l.form,noValidate:!0,onSubmit:o,children:[Object(A.jsx)(g.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Username",name:"email",onChange:i,autoComplete:"email",autoFocus:!0}),Object(A.jsx)(g.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",onChange:i,label:"Password",type:"password",id:"password",autoComplete:"current-password"}),Object(A.jsx)(x.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:l.submit,children:"Sign In"})]})]})})]})},E=180,L=Object(h.a)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),height:55},appBarShift:{width:"calc(100% - ".concat(E,"px)"),height:55,marginLeft:E,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:E,flexShrink:0},drawerPaper:{width:E},drawerHeader:Object(d.a)(Object(d.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-180},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}})),D=n(4),R=n(208),B=n(209),T=n(210),F=n(107),G=n.n(F),H=function(e){var t=e.open,n=e.handleDrawerOpen,a=e.onLogOut,r=L();return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(c.a,{}),Object(A.jsx)(R.a,{position:"fixed",className:Object(D.a)(r.appBar,Object(y.a)({},r.appBarShift,t)),color:"default",children:Object(A.jsxs)(B.a,{children:[Object(A.jsx)(T.a,{color:"inherit","aria-label":"open drawer",onClick:n,edge:"start",className:Object(D.a)(r.menuButton,t&&r.hide),children:Object(A.jsx)(G.a,{})}),Object(A.jsx)(b.a,{variant:"h6",noWrap:!0}),Object(A.jsx)(x.a,{href:"/",onClick:a,style:{marginLeft:"80%",fontSize:16},color:"inherit",children:"Log-out"})]})})]})},V=n(20),q=n(218),z=n(108),M=n.n(z),K=n(109),W=n.n(K),P=n(211),U=n(206),J=n(212),Y=n(213),Q=n(214),X=n(110),Z=n.n(X),$=n(111),_=n.n($),ee=function(e){var t=e.open,n=e.handleDrawerClose,a=L(),r=Object(V.a)();return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(q.a,{className:a.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:a.drawerPaper},children:[Object(A.jsx)("div",{className:a.drawerHeader,children:Object(A.jsx)(T.a,{color:"inherit",onClick:n,children:"ltr"===r.direction?Object(A.jsx)(M.a,{}):Object(A.jsx)(W.a,{})})}),Object(A.jsx)(P.a,{}),Object(A.jsx)(U.a,{children:["Inbox","Starred","Send email","Drafts"].map((function(e,t){return Object(A.jsxs)(J.a,{button:!0,children:[Object(A.jsx)(Y.a,{children:t%2===0?Object(A.jsx)(Z.a,{}):Object(A.jsx)(_.a,{})}),Object(A.jsx)(Q.a,{primary:e})]},e)}))})]})})},te=(n(155),function(e){if("action"===e.column.colId&&e.event.target.dataset.action){var t=e.event.target.dataset.action;"edit"===t&&e.api.startEditingCell({rowIndex:e.node.rowIndex,colKey:e.columnApi.getDisplayedCenterColumns()[0].colId}),"update"===t&&e.api.stopEditing(!1),"cancel"===t&&e.api.stopEditing(!0)}}),ne=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},ae=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},re=function(){function e(){}return e.prototype.createGui=function(){var e=document.createElement("div");e.innerHTML='<span><span id="theValue" style="padding-left: 4px;"></span><button style="float:right" id="theButton"><i class="fa fa-pencil" aria-hidden="true"></i></button></span>',this.eGui=e.firstElementChild},e.prototype.init=function(e){this.createGui(),this.params=e,this.eGui.querySelector("#theValue").innerHTML=e.value,this.eButton=this.eGui.querySelector("#theButton"),this.buttonClickListener=this.onButtonClicked.bind(this),this.eButton.addEventListener("click",this.buttonClickListener)},e.prototype.onButtonClicked=function(){var e={rowIndex:this.params.rowIndex,colKey:this.params.column.getId()};this.params.api.startEditingCell(e)},e.prototype.getGui=function(){return this.eGui},e.prototype.destroy=function(){this.eButton.removeEventListener("click",this.buttonClickListener)},e},ie=n(66),oe=(n(96),n(97),n(98),n(51)),ce=n.n(oe);var se=[{headerName:"ID",field:"id",sortable:!0,filter:!0,editable:!1},{headerName:"Key",field:"key",sortable:!0,filter:!0,editable:!1,width:400},{headerName:"Name",field:"name",sortable:!0,filter:!0,cellRenderer:re()},{headerName:"Owner",field:"owner",sortable:!0,filter:!0,editable:!1},{headerName:"Expires at",field:"expiresAt",sortable:!0,filter:!0,cellRenderer:re(),valueFormatter:function(e){return new Date(e.value).toLocaleDateString()}},{headerName:"Action",minWidth:150,cellRenderer:function(e){var t=document.createElement("div"),n=e.api.getEditingCells().some((function(t){return t.rowIndex===e.node.rowIndex}));return t.innerHTML=n?'\n    <i class="fa fa-check" data-action="update"></i>\n    <i class="fa fa-times" data-action="cancel"></i>\n  ':'\n    <i class="fa fa-edit" data-action="edit"></i>\n  ',t},editable:!1,colId:"action",width:80}],le={editable:!0,width:220},de=function(e){console.log(e.data),ce()({title:"Are you sure to update this row?",icon:"warning",buttons:!0,dangerMode:!0}).then((function(t){if(t){var n=e.data;(function(e,t,n){var a=localStorage.getItem("token"),r={name:t,expiresAt:n},i={method:"patch",headers:{Authorization:"token ".concat(a)},url:N.baseAddress+"key/"+e,data:r};return S()(i).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))})(n.id,n.name,n.expiresAt).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),ce()("Updated!","Your key has been updated!","success")}}))},ue=function(e){Object(l.a)(e);var t=Object(a.useState)(),n=Object(k.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){(function(e){return S.a.get(N.baseAddress+"key",{headers:{Authorization:"token ".concat(e)}}).then((function(e){return e.data})).catch((function(e){console.error(e)}))})(localStorage.getItem("token")).then((function(e){return i(e)})).catch((function(e){return console.log(e)}))}),[]),Object(A.jsx)("div",{className:"ag-theme-alpine tcl-mask",style:{width:"70%",height:"500px"},children:Object(A.jsx)(ie.AgGridReact,{onRowEditingStopped:ae,onRowEditingStarted:ne,onCellClicked:te,columnDefs:se,rowData:r,rowSelection:"multiple",editType:"fullRow",defaultColDef:le,suppressClickEdit:!0,enableRangeSelection:!0,onRowValueChanged:de})})},he=(n(100),n(67)),je=n(220),pe=n(68),me=n.n(pe);n(101);var fe=function(e){Object(l.a)(e);var t=function(e){e.preventDefault();var t=e.target.name.value,n=e.target.owner.value,a=e.target.expire.value;console.log(a),function(e,t,n){var a=localStorage.getItem("token"),r={name:e,owner:t,expiresAt:n},i={method:"post",headers:{Authorization:"token ".concat(a)},url:N.baseAddress+"key",data:r};return S()(i).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))}(t,n,a).then((function(e){400===e.status?alert(e.data):(alert("created success"),window.location.reload(!1))}))};return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(he.a,{trigger:Object(A.jsx)(je.a,{title:"Create a new key",children:Object(A.jsx)(T.a,{children:Object(A.jsx)(me.a,{})})}),modal:!0,children:function(e){return Object(A.jsxs)("div",{className:"modal",children:[Object(A.jsx)("button",{className:"close",onClick:e,children:"\xd7"}),Object(A.jsx)("div",{className:"header",children:" Add a new key "}),Object(A.jsx)("div",{className:"content",children:Object(A.jsxs)("form",{onSubmit:t,children:[Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress",children:"Name"}),Object(A.jsx)("input",{type:"text",name:"name",className:"form-control",id:"inputAddress",placeholder:""})]}),Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress2",children:"Owner"}),Object(A.jsx)("input",{type:"text",name:"owner",className:"form-control",id:"inputAddress2",placeholder:""})]}),Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress2",children:"Expires At"}),Object(A.jsx)("input",{id:"party",name:"expire",type:"datetime-local",defaultValue:"2022-01-01T00:00"})]}),Object(A.jsx)(x.a,{style:{marginTop:"20px"},type:"submit",variant:"contained",color:"primary",children:"Submit"})]})}),Object(A.jsx)("button",{className:"close",onClick:function(){e()},children:"\xd7"})]})}})})},be=function(e){if("action"===e.column.colId&&e.event.target.dataset.action){var t=e.event.target.dataset.action;"edit"===t&&e.api.startEditingCell({rowIndex:e.node.rowIndex,colKey:e.columnApi.getDisplayedCenterColumns()[0].colId}),"update"===t&&e.api.stopEditing(!1),"cancel"===t&&e.api.stopEditing(!0)}},ge=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},xe=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})};var Oe=[{headerName:"ID",field:"id",sortable:!0,filter:!0,editable:!1},{headerName:"Name",field:"name",sortable:!0,filter:!0,cellRenderer:function(){function e(){}return e.prototype.createGui=function(){var e=document.createElement("div");e.innerHTML='<span><span id="theValue" style="padding-left: 4px;"></span><button style="float:right" id="theButton"><i class="fa fa-pencil" aria-hidden="true"></i></button></span>',this.eGui=e.firstElementChild},e.prototype.init=function(e){this.createGui(),this.params=e,this.eGui.querySelector("#theValue").innerHTML=e.value,this.eButton=this.eGui.querySelector("#theButton"),this.buttonClickListener=this.onButtonClicked.bind(this),this.eButton.addEventListener("click",this.buttonClickListener)},e.prototype.onButtonClicked=function(){var e={rowIndex:this.params.rowIndex,colKey:this.params.column.getId()};this.params.api.startEditingCell(e)},e.prototype.getGui=function(){return this.eGui},e.prototype.destroy=function(){this.eButton.removeEventListener("click",this.buttonClickListener)},e}()},{headerName:"Details",field:"details",sortable:!0,filter:!0},{headerName:"URL",field:"url",sortable:!0,filter:!0,width:300},{headerName:"Action",minWidth:150,cellRenderer:function(e){var t=document.createElement("div"),n=e.api.getEditingCells().some((function(t){return t.rowIndex===e.node.rowIndex}));return t.innerHTML=n?'\n    <i class="fa fa-check" data-action="update"></i>\n    <i class="fa fa-times" data-action="cancel"></i>\n  ':'\n    <i class="fa fa-edit" data-action="edit"></i>\n  ',t},editable:!1,colId:"action",width:80}],ve={editable:!0,width:220},we=function(e){console.log(e.data),ce()({title:"Are you sure to update this row?",icon:"warning",buttons:!0,dangerMode:!0}).then((function(t){if(t){console.log(e.data);var n=e.data;(function(e,t,n,a){var r=localStorage.getItem("token"),i={name:e,details:t,url:n},o={method:"patch",headers:{Authorization:"token ".concat(r)},url:N.baseAddress+"target/"+a,data:i};return S()(o).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))})(n.name,n.details,n.url,n.id).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),ce()("Updated!","Your key has been updated!","success")}}))},ye=function(e){Object(l.a)(e);var t=Object(a.useState)(),n=Object(k.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){(function(e){return S.a.get(N.baseAddress+"target",{headers:{Authorization:"token ".concat(e)}}).then((function(e){return e.data})).catch((function(e){console.error(e)}))})(localStorage.getItem("token")).then((function(e){console.log(e),i(e)})).catch((function(e){return console.log(e)}))}),[]),Object(A.jsx)("div",{className:"ag-theme-alpine tcl-mask",style:{width:"70%",height:"500px"},children:Object(A.jsx)(ie.AgGridReact,{onRowEditingStopped:xe,onRowEditingStarted:ge,onCellClicked:be,columnDefs:Oe,rowData:r,rowSelection:"multiple",editType:"fullRow",defaultColDef:ve,suppressClickEdit:!0,enableRangeSelection:!0,onRowValueChanged:we})})};var ke=function(e){Object(l.a)(e);var t=function(e){e.preventDefault();var t=e.target.name.value;(function(e,t,n,a){var r=localStorage.getItem("token"),i={key:e,name:t,url:n,details:a},o={method:"post",headers:{Authorization:"token ".concat(r)},url:N.baseAddress+"target",data:i};return S()(o).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))})(e.target.key.value,t,e.target.url.value,e.target.details.value).then((function(e){400===e.status?alert(e.data):(alert("created success"),window.location.reload(!1))}))};return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(he.a,{trigger:Object(A.jsx)(je.a,{title:"Create a new key",children:Object(A.jsx)(T.a,{children:Object(A.jsx)(me.a,{})})}),modal:!0,children:function(e){return Object(A.jsxs)("div",{className:"modal",children:[Object(A.jsx)("button",{className:"close",onClick:e,children:"\xd7"}),Object(A.jsx)("div",{className:"header",children:" Add a new key "}),Object(A.jsx)("div",{className:"content",children:Object(A.jsxs)("form",{onSubmit:t,children:[Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress",children:"Name"}),Object(A.jsx)("input",{type:"text",name:"name",className:"form-control",id:"inputAddress",placeholder:""})]}),Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress2",children:"Key"}),Object(A.jsx)("input",{type:"text",name:"key",className:"form-control",id:"inputAddress2",placeholder:""})]}),Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress2",children:"URL"}),Object(A.jsx)("input",{type:"text",name:"url",className:"form-control",id:"inputAddress2",placeholder:"http://nmas.nome.fi:",defaultValue:"http://nmas.nome.fi:"})]}),Object(A.jsxs)("div",{className:"form-group",children:[Object(A.jsx)("label",{htmlFor:"inputAddress2",children:"Details"}),Object(A.jsx)("input",{type:"text",name:"details",className:"form-control",id:"inputAddress2",placeholder:""})]}),Object(A.jsx)(x.a,{style:{marginTop:"20px"},type:"submit",variant:"contained",color:"primary",children:"Submit"})]})}),Object(A.jsx)("button",{className:"close",onClick:function(){e()},children:"\xd7"})]})}})})},Ne=(n(162),function(e){var t=e.getNewToken;return Object(a.useEffect)((function(){t()}),[]),Object(A.jsxs)("div",{className:"container",children:[Object(A.jsx)(fe,{}),Object(A.jsx)("h1",{children:"Available Keys"}),Object(A.jsx)(ue,{}),Object(A.jsx)("br",{}),Object(A.jsx)("h1",{children:"Active Targets"}),Object(A.jsx)(ke,{}),Object(A.jsx)(ye,{})]})});var Ce=function(e){Object(l.a)(e);var t=L(),n=r.a.useState(!1),i=Object(k.a)(n,2),o=i[0],c=i[1],s=function(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},d=function(){(function(e){return S.a.post(N.baseAddress+"/login",{token:e}).then((function(e){return e.data})).catch((function(e){return e.response.status}))})(localStorage.getItem("refreshToken")).then((function(e){401===e||403===e?(alert("Please login!"),s(),window.location.reload(!1)):localStorage.setItem("token",e.token)})).catch((function(e){return console.error(e)}))};return Object(a.useEffect)((function(){var e=setInterval((function(){null!==localStorage.getItem("token")&&(d(),console.log("This will run every 30 seconds!"))}),3e4);return function(){return clearInterval(e)}})),localStorage.getItem("token")?Object(A.jsxs)("div",{className:t.root,children:[Object(A.jsx)(H,{open:o,handleDrawerOpen:function(){return c(!0)},onLogOut:s}),Object(A.jsx)(ee,{open:o,handleDrawerClose:function(){return c(!1)}}),Object(A.jsxs)("main",{className:Object(D.a)(t.content,Object(y.a)({},t.contentShift,o)),children:[Object(A.jsx)("div",{className:t.drawerHeader}),Object(A.jsx)(Ne,{getNewToken:d})]})]}):Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(u.a,{to:"/"})})},Se=function(){return Object(a.useEffect)((function(){})),Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(Ce,{})})},Ae=n(38),Ie=function(){return Object(A.jsxs)("div",{children:[Object(A.jsx)("h1",{children:"404"}),Object(A.jsx)("h2",{children:"Error: 404 page not found"}),Object(A.jsx)("p",{children:"Sorry, the page you're looking for cannot be accessed"}),Object(A.jsx)(Ae.b,{to:"/",children:"Click here to go back to home"})]})},Ee=function(e){return Object(l.a)(e),Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(u.d,{children:[Object(A.jsx)(u.b,{path:"/",exact:!0,render:function(e){return Object(A.jsx)(I,Object(d.a)(Object(d.a)({},e),{},{onLoginRedirect:"/dashboard"}))}}),Object(A.jsx)(u.b,{path:"/dashboard",exact:!0,render:function(e){return Object(A.jsx)(Se,Object(d.a)({},e))}}),Object(A.jsx)(u.b,{component:Ie})]})})},Le=function(e){return Object(l.a)(e),Object(A.jsx)(Ae.a,{children:Object(A.jsx)(Ee,{})})},De=n(113),Re=n.n(De),Be=n(114),Te=Object(Be.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:Re.a.A400},background:{default:"#fff"}}});o.a.render(Object(A.jsxs)(s.a,{theme:Te,children:[Object(A.jsx)(c.a,{}),Object(A.jsx)(Le,{})]}),document.querySelector("#root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.b587f9d8.chunk.js.map