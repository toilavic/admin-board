(this["webpackJsonpcreate-react-app-with-typescript"]=this["webpackJsonpcreate-react-app-with-typescript"]||[]).push([[0],{12:function(e){e.exports=JSON.parse('{"baseAddress":"https://api.nome.fi:54321/v1/"}')},162:function(e,t,n){},163:function(e,t,n){},166:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(10),c=n.n(o),i=n(203),s=n(222),l=n(16),d=n(39),u=n(27),j=n(18),h=n(11),b=n(198),m=Object(b.a)((function(e){return{root:{height:"100vh"},image:{backgroundImage:"url(img/chess.jpg)",backgroundRepeat:"no-repeat",backgroundColor:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[900],backgroundSize:"cover",backgroundPosition:"center"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(2,0,2)}}})),p=n(201),f=n(118),g=n(226),x=n(68),O=n(223),v=n(207),y=n(81),k=n.n(y),w=n(111),S=n(12),N=n(13),C=n.n(N);var I=n(2),A=function(e){var t=e.onLoginRedirect,n=e.history,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(a.useState)(t),r=Object(j.a)(n,2),o=r[0],c=r[1];return{onChange:function(e){c(Object(u.a)(Object(u.a)({},o),{},Object(d.a)({},e.target.name,e.target.value)))},onSubmit:function(){var t=Object(w.a)(k.a.mark((function t(n){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,e();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),values:o}}((function(){(e=s,C.a.post(S.baseAddress+"login",e).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))).then((function(e){if(401===e.status){var a=e.data;alert(a)}else{var r=e.data;r&&("admin"===r.user.permissionLevel?(localStorage.setItem("token",r.token),localStorage.setItem("refreshToken",r.refreshToken),n.push(t)):alert("you are not admin"))}}));var e}),{email:"",password:""}),o=r.onChange,c=r.onSubmit,s=r.values;var l=m();return localStorage.getItem("token")?Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(h.a,{to:"/dashboard"})}):Object(I.jsxs)(p.a,{container:!0,component:"main",className:l.root,children:[Object(I.jsx)(i.a,{}),Object(I.jsx)(p.a,{item:!0,xs:!1,sm:4,md:7,className:l.image}),Object(I.jsx)(p.a,{item:!0,xs:12,sm:8,md:5,component:f.a,elevation:6,square:!0,children:Object(I.jsxs)("div",{className:l.paper,children:[Object(I.jsx)(g.a,{className:l.avatar}),Object(I.jsx)(x.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(I.jsxs)("form",{className:l.form,noValidate:!0,onSubmit:c,children:[Object(I.jsx)(O.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Username",name:"email",onChange:o,autoComplete:"email",autoFocus:!0}),Object(I.jsx)(O.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",onChange:o,label:"Password",type:"password",id:"password",autoComplete:"current-password"}),Object(I.jsx)(v.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:l.submit,children:"Sign In"})]})]})})]})},E=n(67),D=n.n(E),T=n(208),R=n(209),L=n(210),F=Object(b.a)((function(e){return{root:{maxWidth:300,borderRadius:40,padding:30,lineHeight:1.5,boxShadow:"0px 2px 8px rgba(0,0,0,0.05)",transition:"transform 280ms ease-in-out, box-shadow 200ms ease-in-out","&:hover":{transform:"translateY(-10px)",boxShadow:"0px 4px 16px rgba(0,0,0,0.1)"}},keys:{marginTop:20,display:"flex"},keyIcon:{marginLeft:20,fontSize:34,transform:"rotate(-90deg)",color:"rgb(37, 150, 190)",display:"flex",justifyContent:"center",alignItems:"center",marginTop:"7px"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:18,fontWeight:400},pos:{marginBottom:12}}}));function z(e){return C.a.get(S.baseAddress+"key",{headers:{Authorization:"token ".concat(e)}}).then((function(e){return e.data})).catch((function(e){console.error(e)}))}function B(){var e=F(),t=localStorage.getItem("token"),n=r.a.useState(0),o=Object(j.a)(n,2),c=o[0],i=o[1];return Object(a.useEffect)((function(){z(t).then((function(e){i(e.length)})).catch((function(e){return console.log(e)}))})),Object(I.jsxs)(T.a,{className:e.root,children:[Object(I.jsxs)(R.a,{children:[Object(I.jsx)(x.a,{className:e.title,gutterBottom:!0,children:"Available Keys"}),Object(I.jsxs)(x.a,{className:e.keys,variant:"h4",component:"h5",children:[c,Object(I.jsx)(D.a,{className:e.keyIcon})]})]}),Object(I.jsx)(L.a,{children:Object(I.jsx)(v.a,{href:"/dashboard/keys",size:"small",children:"Learn More"})})]})}var W=n(211);function K(e){return C.a.get(S.baseAddress+"target",{headers:{Authorization:"token ".concat(e)}}).then((function(e){return e.data})).catch((function(e){console.error(e)}))}function H(){var e=F(),t=localStorage.getItem("token"),n=r.a.useState(0),o=Object(j.a)(n,2),c=o[0],i=o[1];return Object(a.useEffect)((function(){K(t).then((function(e){return i(e.length)})).catch((function(e){return console.log(e)}))}),[]),Object(I.jsxs)(T.a,{className:e.root,children:[Object(I.jsxs)(R.a,{children:[Object(I.jsx)(x.a,{className:e.title,gutterBottom:!0,children:"Available Targets"}),Object(I.jsxs)(x.a,{className:e.keys,variant:"h4",component:"h5",children:[c,Object(I.jsx)(W.a,{className:e.keyIcon})]})]}),Object(I.jsx)(L.a,{children:Object(I.jsx)(v.a,{href:"/dashboard/active-keys",size:"small",children:"Learn More"})})]})}var G=220,P=Object(b.a)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),height:55},appBarShift:{width:"calc(100% - ".concat(G,"px)"),height:55,marginLeft:G,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},title:{fontSize:14,fontWeight:500,marginLeft:20},items:{fontSize:15,marginTop:"0.2rem"},selected:{backgroundColor:"rgb(197, 250, 211) !important",color:"green",fontWeight:60},hide:{display:"none"},drawer:{width:G,flexShrink:0},drawerPaper:{width:G},drawerHeader:Object(u.a)(Object(u.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-220},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}})),M=(n(76),n(49)),U=n(227),V=n(212);n(77);var q=n(24),J=n.n(q);var Y=function(e){Object(l.a)(e);var t=function(e){e.preventDefault(),function(e,t,n){var a=localStorage.getItem("token"),r={name:e,owner:t,expiresAt:n},o={method:"post",headers:{Authorization:"token ".concat(a)},url:S.baseAddress+"key",data:r};return C()(o).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))}(e.target.name.value,e.target.owner.value,e.target.expire.value).then((function(e){if(console.log(e),400===e.status)alert(e.data);else if(403===e.status)alert(e.data);else{var t=e.data.key;J()({text:"Key created",button:{text:"Copy key"},content:{element:"input",attributes:{placeholder:"key",type:"input",value:t}}}).then((function(){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t,e.select(),document.execCommand("copy"),document.body.removeChild(e),J()("Key copied!",{icon:"success"})}))}}))};return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(M.a,{closeOnDocumentClick:!1,trigger:Object(I.jsx)(U.a,{title:"Create a new key",children:Object(I.jsx)(V.a,{children:Object(I.jsx)(D.a,{})})}),modal:!0,children:function(e){return Object(I.jsxs)("div",{className:"modal",children:[Object(I.jsx)("button",{className:"close",onClick:e,children:"\xd7"}),Object(I.jsx)("div",{className:"header",children:" Add a new key "}),Object(I.jsx)("div",{className:"content",children:Object(I.jsxs)("form",{onSubmit:t,children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"inputAddress",children:"Name"}),Object(I.jsx)("input",{type:"text",name:"name",placeholder:""})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"inputAddress2",children:"Owner"}),Object(I.jsx)("input",{type:"text",name:"owner",placeholder:""})]}),Object(I.jsxs)("div",{children:["Expires At",Object(I.jsx)("input",{name:"expire",type:"datetime-local",defaultValue:"2022-01-01T00:00"}),Object(I.jsx)(v.a,{style:{marginTop:"20px"},type:"submit",variant:"contained",color:"primary",children:"Submit"})]})]})}),Object(I.jsx)("button",{className:"close",onClick:function(){e()},children:"\xd7"})]})}})})};var Z=function(e){Object(l.a)(e);var t=function(e){e.preventDefault();var t=e.target.name.value;(function(e,t,n,a){var r=localStorage.getItem("token"),o={key:e,name:t,url:n,details:a},c={method:"post",headers:{Authorization:"token ".concat(r)},url:S.baseAddress+"target",data:o};return C()(c).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))})(e.target.key.value,t,"http://nmas.nome.fi:"+e.target.url.value,e.target.details.value).then((function(e){console.log(e),400===e.status||403===e.status?alert(e.data):(alert("created success !"),window.location.reload(!1))}))};return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(M.a,{trigger:Object(I.jsx)(U.a,{title:"Create a new target",children:Object(I.jsx)(V.a,{children:Object(I.jsx)(W.a,{})})}),modal:!0,children:function(e){return Object(I.jsxs)("div",{className:"modal",children:[Object(I.jsx)("button",{className:"close",onClick:e,children:"\xd7"}),Object(I.jsx)("div",{className:"header",children:" Add a new target "}),Object(I.jsx)("div",{className:"content",children:Object(I.jsxs)("form",{onSubmit:t,children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"inputAddress",children:"Name"}),Object(I.jsx)("input",{type:"text",name:"name",placeholder:""})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"inputAddress2",children:"Key"}),Object(I.jsx)("input",{type:"text",name:"key",placeholder:""})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"inputAddress2",children:"Port"}),Object(I.jsx)("input",{type:"text",name:"url",placeholder:"50000"})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"inputAddress2",children:"Details"}),Object(I.jsx)("input",{type:"text",name:"details",placeholder:""})]}),Object(I.jsx)(v.a,{style:{marginTop:"20px"},type:"submit",variant:"contained",color:"primary",children:"Submit"})]})}),Object(I.jsx)("button",{className:"close",onClick:function(){e()},children:"\xd7"})]})}})})};var Q=n(84),X=n.n(Q),$=n(50),_=(n(78),n(79),n(80),[{headerName:"Name",field:"name",sortable:!0,filter:!0,flex:1},{headerName:"Email",field:"email",sortable:!0,filter:!0,editable:!1,flex:1}]),ee={editable:!0,width:220,colSpan:function(e){return 2===e.data?3:1},filter:!0},te=function(e){var t=e.usersInfo;return Object(I.jsxs)("div",{className:"ag-theme-alpine",style:{width:"90%",marginLeft:"1rem"},children:[Object(I.jsx)("h4",{children:"Result"}),Object(I.jsx)($.AgGridReact,{columnDefs:_,rowData:t,rowSelection:"multiple",editType:"fullRow",defaultColDef:ee,suppressClickEdit:!0,enableRangeSelection:!0,domLayout:"autoHeight",suppressCopyRowsToClipboard:!0})]})};var ne=function(e){var t=r.a.useState([]),n=Object(j.a)(t,2),a=n[0],o=n[1];Object(l.a)(e);var c=function(e){e.preventDefault(),function(e){var t=localStorage.getItem("token"),n={includeUsers:!0,key:e},a={method:"get",headers:{Authorization:"token ".concat(t)},url:S.baseAddress+"key",params:n};return C()(a).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))}(e.target.key.value).then((function(e){console.log(e.data[0].users),void 0===e.data[0]?alert("Invalid key"):o(e.data[0].users)}))};return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(M.a,{trigger:Object(I.jsx)(U.a,{title:"Search users by key",children:Object(I.jsx)(V.a,{children:Object(I.jsx)(X.a,{})})}),modal:!0,children:function(e){return Object(I.jsxs)("div",{className:"modal",children:[Object(I.jsx)("button",{className:"close",onClick:e,children:"\xd7"}),Object(I.jsx)("div",{className:"header",children:" Search users by key "}),Object(I.jsx)("div",{children:Object(I.jsxs)("form",{onSubmit:c,children:[Object(I.jsx)("br",{}),"Key: ",Object(I.jsx)("input",{type:"text",name:"key",className:"form-control key-input",id:"inputAddress",placeholder:""}),"  \xa0",Object(I.jsx)(v.a,{type:"submit",variant:"contained",color:"primary",children:Object(I.jsx)(X.a,{})}),Object(I.jsx)(te,{usersInfo:a}),Object(I.jsx)("br",{})]})}),Object(I.jsx)("button",{className:"close",onClick:function(){e()},children:"\xd7"})]})}})})},ae=Object(b.a)((function(e){return{root:{maxWidth:300,borderRadius:40,padding:30,lineHeight:1.5,boxShadow:"0px 2px 8px rgba(0,0,0,0.05)"}}})),re=function(e){Object(l.a)(e);var t=ae();return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("h1",{children:"Tools"}),Object(I.jsx)(T.a,{className:t.root,children:Object(I.jsxs)(R.a,{children:[Object(I.jsx)(Y,{}),Object(I.jsx)(Z,{}),Object(I.jsx)(ne,{})]})})]})},oe=(n(162),function(e){Object(l.a)(e);var t=P();return Object(I.jsxs)("div",{className:"container",children:[Object(I.jsx)("div",{className:t.drawerHeader}),Object(I.jsx)("h1",{children:"Dashboard"}),Object(I.jsxs)("div",{className:"progress",children:[Object(I.jsx)("div",{className:"keys",children:Object(I.jsx)(B,{})}),Object(I.jsx)("div",{className:"active-keys",children:Object(I.jsx)(H,{})})]}),Object(I.jsx)("div",{className:"grid",children:Object(I.jsx)(re,{})})]})}),ce=(n(163),n(55)),ie=n.n(ce),se=(n(164),function(e){if("action"===e.column.colId&&e.event.target.dataset.action){var t=e.event.target.dataset.action;"edit"===t&&e.api.startEditingCell({rowIndex:e.node.rowIndex,colKey:e.columnApi.getDisplayedCenterColumns()[0].colId}),"update"===t&&e.api.stopEditing(!1),"cancel"===t&&e.api.stopEditing(!0)}}),le=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},de=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},ue=function(){function e(){}return e.prototype.init=function(e){this.eInput=document.createElement("input"),this.eInput.value=e.value,ie()(this.eInput).datepicker({dateFormat:"yy-mm-ddT00:00:00.000Z"})},e.prototype.getGui=function(){return this.eInput},e.prototype.afterGuiAttached=function(){this.eInput.focus(),this.eInput.select()},e.prototype.getValue=function(){return this.eInput.value},e.prototype.destroy=function(){},e.prototype.isPopup=function(){return!1},e};var je=[{headerName:"Key",field:"key",sortable:!0,filter:!0,editable:!1,flex:2},{headerName:"Name",field:"name",sortable:!0,filter:!0,flex:1},{headerName:"Owner",field:"owner",sortable:!0,filter:!0,editable:!1,flex:1},{headerName:"Expires at",field:"expiresAt",sortable:!0,filter:!0,flex:1.5,maxWidth:400,cellEditor:"datePicker",valueFormatter:function(e){var t=(new Date).toISOString().substring(0,10),n=new Date(e.value).toISOString().substring(0,10);return n+" ("+Math.floor((Date.parse(n)-Date.parse(t))/864e5)+" days left)"}},{headerName:"Action",minWidth:150,cellRenderer:function(e){var t=document.createElement("div"),n=e.api.getEditingCells().some((function(t){return t.rowIndex===e.node.rowIndex}));return t.innerHTML=n?'\n    <i class="fa fa-check" data-action="update" style="color:green"></i>\n    <i class="fa fa-times" data-action="cancel"></i>\n  ':'\n    <i class="fa fa-edit" data-action="edit" style="color:blue"></i>\n  ',t},editable:!1,colId:"action",width:80}],he={editable:!0,width:220,colSpan:function(e){return 2===e.data?3:1},filter:!0},be=function(e){console.log(e.data),J()({title:"Are you sure to update this row?",icon:"warning",buttons:!0,dangerMode:!0}).then((function(t){if(t){var n=e.data;(function(e,t,n){var a=localStorage.getItem("token"),r={name:t,expiresAt:n},o={method:"patch",headers:{Authorization:"token ".concat(a)},url:S.baseAddress+"key/"+e,data:r};return C()(o).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))})(n.id,n.name,n.expiresAt).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})),J()("Updated!","Your key has been updated!","success")}}))},me=function(e){Object(l.a)(e);var t=Object(a.useState)(),n=Object(j.a)(t,2),r=n[0],o=n[1],c=localStorage.getItem("token");return Object(a.useEffect)((function(){z(c).then((function(e){return o(e)})).catch((function(e){return console.log(e)}))}),[]),Object(a.useEffect)((function(){var e=setInterval((function(){localStorage.getItem("token"),console.log("new token applied 2 mins ago !")}),12e4);return function(){return clearInterval(e)}})),Object(I.jsxs)("div",{className:"ag-theme-alpine container",style:{width:"80%",height:"500px",marginTop:"100px"},children:[Object(I.jsx)("h1",{children:"Available Keys"}),Object(I.jsx)($.AgGridReact,{onRowEditingStopped:de,onRowEditingStarted:le,onCellClicked:se,columnDefs:je,rowData:r,rowSelection:"multiple",editType:"fullRow",defaultColDef:he,suppressClickEdit:!0,enableRangeSelection:!0,onRowValueChanged:be,suppressCopyRowsToClipboard:!0,domLayout:"autoHeight",components:{datePicker:ue()}})]})},pe=n(4),fe=n(213),ge=n(214),xe=n(113),Oe=n.n(xe),ve=function(e){var t=e.open,n=e.handleDrawerOpen,a=e.onLogOut,r=P();return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(i.a,{}),Object(I.jsx)(fe.a,{position:"fixed",className:Object(pe.a)(r.appBar,Object(d.a)({},r.appBarShift,t)),color:"default",style:{background:"inherit",boxShadow:"none"},children:Object(I.jsxs)(ge.a,{children:[Object(I.jsx)(V.a,{color:"inherit","aria-label":"open drawer",onClick:n,edge:"start",className:Object(pe.a)(r.menuButton,t&&r.hide),children:Object(I.jsx)(Oe.a,{})}),Object(I.jsx)(x.a,{variant:"h6",noWrap:!0}),Object(I.jsx)(v.a,{href:"/",onClick:a,style:{marginLeft:"80%",fontSize:16},color:"inherit",children:"Log-out"})]})})]})},ye=n(37),ke=n(21),we=n(225),Se=n(206),Ne=n(217),Ce=n(218),Ie=n(220),Ae=n(215),Ee=n(216),De=n(219),Te=n(221),Re=(n(166),function(e){var t=e.open,n=e.handleDrawerClose,o=P(),c=Object(ke.a)(),i=r.a.useState(0),s=Object(j.a)(i,2),l=s[0],d=s[1],u=function(e,t){d(t)};return Object(a.useEffect)((function(){switch(console.log(window.location.pathname),window.location.pathname){case"/dashboard":d(0);break;case"/dashboard/keys":d(1);break;case"/dashboard/active-keys":d(2);break;default:d(0)}}),[l]),Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(we.a,{className:o.drawer,variant:"persistent",anchor:"left",open:t,classes:{paper:o.drawerPaper},children:[Object(I.jsx)("div",{className:o.drawerHeader,children:Object(I.jsx)(V.a,{color:"inherit",onClick:n,children:"ltr"===c.direction?Object(I.jsx)(Ae.a,{}):Object(I.jsx)(Ee.a,{})})}),Object(I.jsx)(x.a,{className:o.title,gutterBottom:!0,children:"GENERAL"}),Object(I.jsxs)(Se.a,{component:"nav","aria-label":"main folders",children:[Object(I.jsxs)(Ne.a,{button:!0,component:ye.b,to:"/dashboard",classes:{selected:o.selected},selected:0===l,onClick:function(e){return u(0,0)},children:[Object(I.jsx)(Ce.a,{children:Object(I.jsx)(De.a,{})}),Object(I.jsx)(Ie.a,{primary:Object(I.jsx)(x.a,{className:o.items,color:"textSecondary",gutterBottom:!0,children:"Dashboard"})})]}),Object(I.jsx)("br",{}),Object(I.jsx)(x.a,{className:o.title,gutterBottom:!0,children:"TOOLS"}),Object(I.jsxs)(Ne.a,{button:!0,component:ye.b,to:"/dashboard/keys",classes:{selected:o.selected},selected:1===l,onClick:function(e){return u(0,1)},children:[Object(I.jsx)(Ce.a,{children:Object(I.jsx)(Te.a,{})}),Object(I.jsx)(Ie.a,{primary:Object(I.jsx)(x.a,{className:o.items,color:"textSecondary",gutterBottom:!0,children:"Keys"})})]}),Object(I.jsxs)(Ne.a,{button:!0,component:ye.b,to:"/dashboard/active-keys",classes:{selected:o.selected},selected:2===l,onClick:function(e){return u(0,2)},children:[Object(I.jsx)(Ce.a,{children:Object(I.jsx)(W.a,{})}),Object(I.jsx)(Ie.a,{primary:Object(I.jsx)(x.a,{className:o.items,color:"textSecondary",gutterBottom:!0,children:"Active Targets"})})]})]})]})})}),Le=function(e){var t=e.open,n=e.handleDrawerClose,a=e.handleDrawerOpen,r=e.onLogOut,o=P();return localStorage.getItem("token")?Object(I.jsxs)("div",{className:o.root,children:[Object(I.jsx)(ve,{open:t,handleDrawerOpen:a,onLogOut:r}),Object(I.jsx)(Re,{open:t,handleDrawerClose:n})]}):Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(h.a,{to:"/"})})};var Fe=function(e){if("action"===e.column.colId&&e.event.target.dataset.action){var t=e.event.target.dataset.action;if("edit"===t&&e.api.startEditingCell({rowIndex:e.node.rowIndex,colKey:e.columnApi.getDisplayedCenterColumns()[0].colId}),"delete"===t){console.log(e.data);var n=e.data,a=n.id,r=n.name;J()({title:"Are you sure to delete this row? Name: "+r,text:"Once deleted, you will not be able to recover this key!",icon:"warning",buttons:!0,dangerMode:!0}).then((function(t){t&&(function(e){var t=localStorage.getItem("token");return C.a.delete(S.baseAddress+"target/"+e,{headers:{Authorization:"token ".concat(t)}}).then((function(e){return e.data})).catch((function(e){console.error(e)}))}(a).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)})),J()("Deleted!","Your key has been deleted!","success"),e.api.applyTransaction({remove:[e.node.data]}))}))}"update"===t&&e.api.stopEditing(!1),"cancel"===t&&e.api.stopEditing(!0)}},ze=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})},Be=function(e){e.api.refreshCells({columns:["action"],rowNodes:[e.node],force:!0})};var We=[{headerName:"Name",field:"name",sortable:!0,filter:!0},{headerName:"Key",field:"key",editable:!1,sortable:!0,filter:!0,flex:1,valueGetter:function(e){return e.data.key.key}},{headerName:"Details",field:"details",sortable:!0,filter:!0,flex:1},{headerName:"URL",field:"url",sortable:!0,filter:!0,flex:1},{headerName:"Action",minWidth:150,cellRenderer:function(e){var t=document.createElement("div"),n=e.api.getEditingCells().some((function(t){return t.rowIndex===e.node.rowIndex}));return t.innerHTML=n?'\n    <i class="fa fa-check" data-action="update" style="color:green"></i>\n    <i class="fa fa-times" data-action="cancel"></i>\n  ':'\n    <i class="fa fa-edit" data-action="edit" style="color:blue"></i>\n    <i class="fa fa-trash" data-action="delete" style="color:red"></i>\n  ',t},editable:!1,colId:"action",width:80}],Ke={editable:!0,resizable:!0,colSpan:function(e){return 2===e.data?3:1}},He=function(e){J()({title:"Are you sure to update this row?",icon:"warning",buttons:!0,dangerMode:!0}).then((function(t){if(t){var n=e.data;(function(e,t,n,a){var r=localStorage.getItem("token"),o={name:e,details:t,url:n},c={method:"patch",headers:{Authorization:"token ".concat(r)},url:S.baseAddress+"target/"+a,data:o};return C()(c).then((function(e){return e})).catch((function(e){if(e.response)return e.response}))})(n.name,n.details,n.url,n.id).then((function(e){403===e.status?J()("Error!",e.data,"warning"):J()("Updated!",e.data,"success")})).catch((function(e){return console.error(e)}))}}))},Ge=function(e){Object(l.a)(e);var t=Object(a.useState)(),n=Object(j.a)(t,2),r=n[0],o=n[1],c=localStorage.getItem("token");return Object(a.useEffect)((function(){var e=setInterval((function(){localStorage.getItem("token"),console.log("new token applied 2 mins ago !")}),12e4);return function(){return clearInterval(e)}})),Object(a.useEffect)((function(){K(c).then((function(e){console.log(e),o(e)})).catch((function(e){return console.log(e)}))}),[]),Object(I.jsxs)("div",{className:"ag-theme-alpine container",style:{width:"80%",height:"500px",marginTop:"100px"},children:[Object(I.jsx)("h1",{children:"Active Targets"}),Object(I.jsx)($.AgGridReact,{onRowEditingStopped:Be,onRowEditingStarted:ze,onCellClicked:Fe,columnDefs:We,rowData:r,rowSelection:"multiple",editType:"fullRow",defaultColDef:Ke,suppressClickEdit:!0,enableRangeSelection:!0,clipboardDeliminator:",",onRowValueChanged:He,suppressCopyRowsToClipboard:!0,stopEditingWhenCellsLoseFocus:!0,domLayout:"autoHeight"})]})};var Pe=function(e){Object(l.a)(e);var t=P(),n=r.a.useState(!0),o=Object(j.a)(n,2),c=o[0],i=o[1],s=r.a.useState(""),b=Object(j.a)(s,2),m=(b[0],b[1]),p=function(){localStorage.removeItem("token"),localStorage.removeItem("refreshToken")},f=function(){(function(e){return C.a.post(S.baseAddress+"/login",{token:e}).then((function(e){return e.data})).catch((function(e){return e.response.status}))})(localStorage.getItem("refreshToken")).then((function(e){401===e||403===e?(alert("Please login!"),p(),window.location.reload(!1)):(console.log(e.token),m(e.token),localStorage.setItem("token",e.token))})).catch((function(e){return console.error(e)}))},g=localStorage.getItem("token");return Object(a.useEffect)((function(){g&&(console.log("FIRST RENDER...GET NET TOKEN..."),f());var e=setInterval((function(){null!==g&&(f(),console.log("Applied refreshTokenInEveryThirtySeconds!"))}),3e4);return function(){return clearInterval(e)}})),Object(I.jsx)(I.Fragment,{children:Object(I.jsxs)(h.d,{children:[Object(I.jsx)(h.b,{exact:!0,path:"/",render:function(e){return Object(I.jsx)(A,Object(u.a)(Object(u.a)({},e),{},{onLoginRedirect:"/dashboard"}))}}),Object(I.jsxs)("div",{children:[Object(I.jsx)(Le,{open:c,handleDrawerOpen:function(){return i(!0)},handleDrawerClose:function(){return i(!1)},onLogOut:p}),Object(I.jsxs)("main",{className:Object(pe.a)(t.content,Object(d.a)({},t.contentShift,c)),children:[Object(I.jsx)(h.b,{path:"/dashboard",exact:!0,render:function(e){return Object(I.jsx)(oe,Object(u.a)({},e))}}),Object(I.jsx)(h.b,{path:"/dashboard/keys",render:function(e){return Object(I.jsx)(me,Object(u.a)({},e))}}),Object(I.jsx)(h.b,{path:"/dashboard/active-keys",render:function(e){return Object(I.jsx)(Ge,Object(u.a)({},e))}})]})]})]})})},Me=function(e){return Object(l.a)(e),Object(I.jsx)(ye.a,{children:Object(I.jsx)(Pe,{})})},Ue=n(114),Ve=n.n(Ue),qe=n(115),Je=Object(qe.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:Ve.a.A400},background:{default:"#f9f9f9"}}});c.a.render(Object(I.jsxs)(s.a,{theme:Je,children:[Object(I.jsx)(i.a,{}),Object(I.jsx)(Me,{})]}),document.querySelector("#root"))},76:function(e,t,n){}},[[167,1,2]]]);
//# sourceMappingURL=main.a23d800c.chunk.js.map